**Домашнее задание 2:** Работа со spark  
**Цель задания:**
Разработать контейнер со spark-приложением, порабоать с данными в spark и реализация предсказания ML-моделей над текстовыми данными с помощью UDF

Используйте Hadoop 3.3.6.

Используйте следующие точки входа:
1. HDFS: hdfs://master:8020
2. YARN: master:8032

Внутри контейнера выполните следующие **задачи**:
1. Запустить спарк-сессию (SparkSession) с мастером YARN, с 2-мя экзекьюторами.
2. Создание пустой файла на HDFS /sparkExperiments.txt.
3. Прочитать таблицы ratings, tags из директории ml-latest-small; посчитать количество строчек и в том, и в другом датасете. Записать в файл /sparkExperiments.txt сколько было выполнено стейджей и тасок (пишем в формате stages:n tasks:m где n и m - число стейджей и тасок).
4. Записать в файл /sparkExperiments.txt количество уникальных фильмов и уникальных юзеров в таблице “ratings” (пишем в формате filmsUnique:n usersUnique:m где n и m - число фильмов и юзеров).
5. Посчитать и записать в файл /sparkExperiments.txt сколько было поставлено оценок >= 4.0 (пишем в формате goodRating:n где n - число оценок).
6. Посчитать и записать в файл /sparkExperiments.txt разницу во времени в секундах между временем тегирования пользователя данного фильма и временем, когда пользователь поставил оценку фильму. В качестве ответа выведете среднюю дельту по времени (пишем в формате timeDifference:n где n- разница во времени).
7. Посчитать и записать в файл /sparkExperiments.txt среднюю оценку от каждого пользователя, в качестве ответа выведете среднее от всех усредненных оценок всех пользователей (пишем в формате avgRating:n где n - число оценок).
8. Обучите модель предсказания оценок по тегам с помощью TfidfVectorizer и SGDRegressor. Написать UDF, которая делает предсказание рейтинга по столбцу “tag”. Примените UDF к spar-dataframe-у и убедитесь, что udf работает (можно вызвать какой нибудь action, например show(50)). Записать в файл /sparkExperiments.txt, чему равен корень суммы квадратов разностей (RMSE) между предсказанным и истинным значением рейтинга (пишем в формате rmse:n).